---
title: "raw_to_clean"
output: html_document
date: "2025-04-23"
---

## Control under pressure â€” the influence of aversive motivation on adaptive control

## Raw to clean

## Loading packages

```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
library(dplyr)
library(stringr)
```

## Loading raw data

```{r}
raw_data <- read.csv("pilotresults.csv")
```

## Cleaning/filtering data

```{r}
#Filtering columns
raw_data_filtered = raw_data %>% 
  select(-trial_type,
         -trial_index,
         -plugin_version,
         -success,
         -question_order,
         -slider_start,
         -stimulus,
         -time_elapsed
         )

#Filtering practice blocks
practice_value <- "practice"

if (!"name" %in% colnames(raw_data_filtered)) {
  stop("Column 'name' not found in the dataframe.")
}

practice_rows <- which(str_detect(raw_data_filtered$name, practice_value))

if (length(practice_rows) == 0) {
  warning("No rows found containing the string 'practice'.")
} else {
  rows_to_remove <- unique(unlist(lapply(practice_rows, function(i) (i-3):(i+1))))
  
  rows_to_remove <- rows_to_remove[rows_to_remove > 0 & rows_to_remove <= nrow(raw_data_filtered)]
  
  raw_data_filtered <- raw_data_filtered[-rows_to_remove, ]
}



#True/false values to 1/0
raw_data_filtered = raw_data_filtered %>%
  mutate(
    correct = factor(recode(correct,
                             "true" = "1",
                             "false" = "0")))
```


