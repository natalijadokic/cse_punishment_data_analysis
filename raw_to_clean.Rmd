---
title: "raw_to_clean"
output: html_document
date: "2025-04-23"
---

## Control under pressure — the influence of aversive motivation on adaptive control

## Raw to clean

## Loading packages

```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
library(dplyr)
library(stringr)
```

## Loading raw data

```{r}
raw_data <- read.csv("pilotresults.csv")
```

## Cleaning/filtering data

```{r}
#Filtering columns
raw_data_filtered = raw_data %>% 
  select(-trial_type,
         -trial_index,
         -plugin_version,
         -success,
         -question_order,
         -slider_start
         )


#Filtering practice blocks

practice_value <- "practice"

if (!"name" %in% colnames(raw_data_filtered)) {
  stop("Column 'name' not found in the dataframe.")
}

practice_rows <- which(str_detect(raw_data_filtered$name, practice_value))

if (length(practice_rows) == 0) {
  warning("No rows found containing the string 'practice'.")
} else {
  rows_to_remove <- unique(unlist(lapply(practice_rows, function(i) (i-3):(i+1))))
  
  rows_to_remove <- rows_to_remove[rows_to_remove > 0 & rows_to_remove <= nrow(raw_data_filtered)]
  
  raw_data_filtered <- raw_data_filtered[-rows_to_remove, ]
}

#Filtering stimuli

raw_data_filtered = raw_data_filtered %>% 
  filter(response == "n" | response == "j" | response == "f" | response == "g" | response == "null")
#KERESZT
raw_data_filtered$stimulus <- gsub('<div style="font-size:60px;">+</div>', '+', raw_data_filtered$stimulus, fixed = TRUE)

#LE
raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>le<br>le<br>le</span>", 'le le le', raw_data_filtered$stimulus, fixed = TRUE)

raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>le</span>", 'le', raw_data_filtered$stimulus, fixed = TRUE)

#FEL
raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>fel<br>fel<br>fel</span>", 'fel fel fel', raw_data_filtered$stimulus, fixed = TRUE) 

raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>fel</span>", 'fel', raw_data_filtered$stimulus, fixed = TRUE)

#JOBB
raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>jobb<br>jobb<br>jobb</span>", 'jobb jobb jobb', raw_data_filtered$stimulus, fixed = TRUE)

raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>jobb</span>", 'jobb', raw_data_filtered$stimulus, fixed = TRUE)

#BAL

raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>bal<br>bal<br>bal</span>", 'bal bal bal', raw_data_filtered$stimulus, fixed = TRUE)


raw_data_filtered$stimulus <- gsub("<span style='font-size: 35px;'>bal</span>", 'bal', raw_data_filtered$stimulus, fixed = TRUE)

#CHECKMARK
	
raw_data_filtered$stimulus <- gsub("<div style='font-size: 35px; color: black;'>✔</div>", '✔', raw_data_filtered$stimulus, fixed = TRUE)

raw_data_filtered$stimulus <- gsub('<div style="font-size: 35px; color: black;">✘</div>', '✘', raw_data_filtered$stimulus, fixed = TRUE
)

#NEUTRAL FEEDBACK
raw_data_filtered$stimulus <- gsub("<div style='font-size: 35px; color: black; font-weight: bold;'>&#11036</div>", '&#11036', raw_data_filtered$stimulus, fixed = TRUE)
```


